PRO fit_monr2

wav_k=[0.01224489, 0.01627149, 0.0216222 , 0.02873242, 0.03818077, 0.05073609, 0.06742011, 0.08959047, 0.11905132, 0.15820005, 0.21022242, 0.27935177, 0.37121355, 0.49328308, 0.65549385, 0.87104585, 1.15747979, 1.5381044 , 2.04389326, 2.71600528]

gauss=[1.57272774e+04,  1.75389207e+04,  1.61249911e+04,  2.36294285e+04, 1.98254432e+04,  2.18908661e+04,  5.99706435e+02,  4.46836515e+02, 2.35627889e+02,  7.79334908e+01,  2.49117425e+01,  1.77309897e+01, 7.86581207e+00,  3.46338072e+00,  1.18961135e+00,  2.05911817e-01, -3.17431518e-01, -4.07748404e+00, -5.03723594e+01, -2.82222856e+02]

coherent=[-1.62917707e-02, -1.62917707e-02, -1.62917707e-02, -1.62917707e-02, -1.64835050e-02, -1.71336049e-02,  1.50136912e+04,  9.50956295e+03, 5.91116714e+03,  2.94458514e+03,  1.14429462e+03,  3.59508213e+02, 1.39145430e+02,  9.38247331e+01,  8.07175483e+01,  4.77367801e+01, 3.65011916e+01,  2.75521207e+01, -9.68048713e+00, -2.61254767e+02]

;Gauss
A=[0.614082, -2.61187, 0.1]
;Coherent
;A=[10.0457, -2.80084, 27.3838]

std_gauss= 8875.8
std_coherent=3870.5

weights_gauss = 1.0/(gauss/std_gauss)^2
weights_cohe = 1.0/(coherent/std_coherent)^2

curve_w = CURVEFIT(wav_k[7:16], gauss[7:16], weights_gauss[7:16], A, sigma, CHISQ=chisq, fita=[1,1,1], FUNCTION_NAME='power_law',itmax=1000)

print, A

END