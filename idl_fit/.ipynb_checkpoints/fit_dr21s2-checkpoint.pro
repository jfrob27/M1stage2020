PRO fit_dr21s2

wav_k=[0.01071428, 0.01423756, 0.01891942, 0.02514087, 0.03340817, 0.04439408, 0.05899259, 0.07839166, 0.10416991, 0.13842505, 0.18394462, 0.2444328 , 0.32481186, 0.4316227 , 0.57355712, 0.76216512, 1.01279481, 1.34584135, 1.78840661, 2.37650462, 3.15799226]

gauss=[5.48593573e+03,  1.82758001e+04,  8.58132148e+03,  9.97612525e+03, 7.47120434e+03,  3.74922275e+03,  1.65775339e+03,  7.27803875e+02, 3.28123140e+02,  1.86050516e+02,  4.39328334e+01,  2.84917330e+01, 1.03076556e+01,  3.88181060e+00,  1.81721794e+00,  8.41973481e-01, 4.33781048e-01,  1.44837973e-01, -1.97619780e+00, -1.66226399e+01, -1.65235647e+02]

coherent=[-2.37529224e-03, -2.37529224e-03, -2.37529224e-03,  3.11086486e+01, 9.51061949e+01,  1.13562857e+03,  1.19219853e+03,  8.18939118e+02, 7.89575622e+02,  5.45418242e+02,  4.46097167e+02,  2.72971955e+02, 1.73823307e+02,  1.19337570e+02,  7.70941894e+01,  4.91947476e+01, 3.57545508e+01,  2.67618972e+01,  1.95663556e+01, -9.51642108e+00, -1.63281808e+02]

A=[1323.75, -1.43021, 2485.41]

std_gauss= 4677.2
std_coherent=386.9

weights_gauss = 1.0/(gauss/std_gauss)^2
weights_cohe = 1.0/(coherent/std_coherent)^2

curve_w = CURVEFIT(wav_k[8:17], gauss[8:17], weights_gauss[8:17], A, sigma, CHISQ=chisq, fita=[1,1,1], FUNCTION_NAME='power_law',itmax=1000)

print, A

END