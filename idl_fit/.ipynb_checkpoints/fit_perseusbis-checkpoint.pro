PRO fit_perseusbis

wav_k=[0.00451128, 0.00599476, 0.00796607, 0.01058563, 0.0140666 , 0.01869225, 0.02483899, 0.03300702, 0.04386101, 0.05828423, 0.07745036, 0.10291907, 0.13676289, 0.18173587, 0.24149773, 0.32091163, 0.42643992, 0.56667004, 0.75301331, 1.00063353, 1.32968095, 1.76693204, 2.34796838, 3.12007219]

spec=[1.45920670e+05, 1.65695164e+04, 6.71641769e+04, 9.33222622e+04, 2.49359628e+04, 2.40478914e+04, 1.55373442e+04, 6.55182154e+03, 3.96945798e+03, 2.32469784e+03, 1.46600397e+03, 7.46855332e+02, 3.84625642e+02, 1.75508210e+02, 8.90594097e+01, 5.69175410e+01, 3.91222972e+01, 1.86695986e+01, 8.60459215e+00, 5.50868856e+00, 3.50351212e+00, 4.58791569e+00, 5.53776474e+00, 2.24963165e+00]

gauss=[1.45920667e+05,  1.65695134e+04,  6.71641738e+04,  9.33222592e+04, 2.48847180e+04,  2.40478883e+04,  1.03284154e+04,  3.71659486e+03, 1.11307150e+03,  1.70439520e+02,  7.32168973e+01,  2.58616431e+01, 3.93658748e+00,  1.66361335e+00,  6.51428796e-01,  3.09633733e-01, 1.52896940e-01,  8.45185756e-02,  5.22883653e-02,  3.58781649e-02, -6.33768635e-02, -2.07839153e+00, -2.00956175e+01, -1.95557404e+02]

coherent=[-3.05339644e-03, -3.05339644e-03, -3.05339644e-03, -3.05339644e-03, 5.12387292e+01, -3.05339644e-03,  5.20892229e+03,  2.83522006e+03, 2.85637976e+03,  2.15425147e+03,  1.39278002e+03,  7.20986316e+02, 3.80681186e+02,  1.73835993e+02,  8.83982215e+01,  5.65961594e+01, 3.89540663e+01,  1.85622371e+01,  8.51062957e+00,  5.36808249e+00, 3.04565703e+00,  2.91570437e-01, -1.82765567e+01, -1.94828130e+02]

A=[5.3201, -2.1367, 0.01]

std_gauss= 35274.1
std_coherent=1295.5
std_spec=35069.6

weights_spec = 1.0/(spec/std_spec)^2
weights_gauss = 1.0/(gauss/std_gauss)^2
weights_cohe = 1.0/(coherent/std_coherent)^2

curve_w = CURVEFIT(wav_k[6:19], gauss[6:19], weights_gauss[6:19], A, sigma, CHISQ=chisq, fita=[1,1,1], FUNCTION_NAME='power_law',itmax=1000)
print, A

END