PRO fit_perseus

wav_k=[0.00571428, 0.00759336, 0.01009036, 0.01340846, 0.01781769, 0.02367684, 0.03146272, 0.04180889, 0.05555728, 0.07382669, 0.0981038 , 0.13036416, 0.17323299, 0.23019877, 0.30589713, 0.40648807, 0.54015723, 0.71778205, 0.95381686, 1.26746913, 1.68426254, 2.23811392, 2.97409328]

spec=[1.71904794e+05, 1.19280023e+05, 5.07993101e+04, 7.57014540e+04, 1.07926323e+05, 7.25466777e+04, 3.17441704e+04, 2.47265778e+04, 1.37445754e+04, 7.37580039e+03, 4.17663980e+03, 2.49114106e+03, 1.60650682e+03, 8.46746785e+02, 4.45060460e+02, 2.83490878e+02, 1.68101099e+02, 1.06583257e+02, 7.01318771e+01, 5.42761131e+01, 4.76328819e+01, 4.14485597e+01, 1.51768818e+01]

gauss=[1.71904782e+05,  1.19280011e+05,  5.07992978e+04,  7.57014417e+04, 1.07926310e+05,  6.11726482e+04,  1.75074666e+04,  7.26017422e+03, 6.92184080e+02,  1.48321597e+02,  6.37791116e+01,  1.83773436e+01, 3.51838978e+00,  1.13335822e+00,  3.10990645e-01,  1.65232428e-01, 8.05132302e-02,  2.24562933e-02, -7.18348366e-02, -5.09362371e-01, -6.79605027e+00, -6.28562448e+01, -4.64807200e+02]

coherent=[-1.22991000e-02, -1.22991000e-02, -1.22991000e-02, -1.22991000e-02, -1.23586308e-02,  1.13740041e+04,  1.42366782e+04,  1.74663777e+04, 1.30523650e+04,  7.22745181e+03,  4.11283254e+03,  2.47273379e+03, 1.60295585e+03,  8.45576759e+02,  4.44705833e+02,  2.83269593e+02, 1.67939338e+02,  1.06418226e+02,  6.98701761e+01,  5.33529771e+01, 3.88063551e+01, -2.66287995e+01, -4.51737237e+02]

A=[52.0996, -1.90709, 0.1]

std_gauss= 47346.4
std_coherent=5334.0
std_spec=46822.6

weights_spec = 1.0/(spec/std_spec)^2
weights_gauss = 1.0/(gauss/std_gauss)^2
weights_cohe = 1.0/(coherent/std_coherent)^2

curve_w = CURVEFIT(wav_k[8:20], coherent[8:20], weights_cohe[8:20], A, sigma, CHISQ=chisq, fita=[1,1,1], FUNCTION_NAME='power_law',itmax=1000)

print, A

END