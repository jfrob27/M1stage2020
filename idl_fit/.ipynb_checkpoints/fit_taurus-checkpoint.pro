PRO fit_taurus

wav_k=[0.0031746,  0.00421854, 0.00560576, 0.00744915, 0.00989872, 0.0131538, 0.01747929, 0.02322716, 0.03086516, 0.04101483, 0.05450211, 0.07242453, 0.09624055, 0.12788821, 0.16994285, 0.2258267,  0.30008735, 0.39876781, 0.52989825, 0.70414952, 0.93570141, 1.24339662, 1.65227405, 2.19560635, 2.91760757]

spec=[7.11811600e+04, 8.15856106e+03, 6.13417761e+04, 1.40697305e+05, 9.81908112e+04, 3.82676768e+04, 3.20028506e+04, 2.87670007e+04, 1.27733857e+04, 7.09324438e+03, 4.30409476e+03, 2.27249006e+03, 1.04620267e+03, 5.63284254e+02, 3.13716633e+02, 1.53699458e+02, 7.02834062e+01, 3.27111407e+01, 1.43280941e+01, 6.51497235e+00, 3.45752235e+00, 2.82932046e+00, 8.29139205e+00, 3.25292866e+01, 1.80702188e+01]

gauss=[7.11811447e+04,  8.15854576e+03,  6.13417608e+04,  1.40697289e+05, 9.81907959e+04,  3.81724507e+04,  2.06881903e+04,  2.00799066e+04, 4.88955395e+03,  1.40171003e+03,  5.78333922e+02,  1.13270439e+02, 3.24756402e+01,  6.58003622e+00,  2.98096079e+00,  1.25873113e+00, 7.99788930e-01,  4.98956560e-01,  3.21648090e-01,  2.57053618e-01, 1.98714875e-01, -6.81541642e-02, -4.03495907e+00, -5.68069209e+01, -4.64792938e+02]


coherent=[-1.53032400e-02, -1.53032400e-02, -1.53032400e-02, -1.53032400e-02, -1.53032400e-02,  9.51945758e+01,  1.13146290e+04,  8.68706384e+03, 7.88380082e+03,  5.69150315e+03,  3.72572913e+03,  2.15918708e+03, 1.01369313e+03,  5.56668224e+02,  3.10696567e+02,  1.52396834e+02, 6.94316138e+01,  3.21457854e+01,  1.39111930e+01,  6.09325026e+00, 2.88344423e+00,  1.37259381e+00, -3.40358678e+00, -5.37250249e+01, -4.60345723e+02]

A=[4.4959247, -2.32844418, 1]

std_gauss= 35776.3
std_coherent= 3164.6
std_spec= 35549.03

weights_spec = 1.0/(spec/std_spec)^2
weights_gauss = 1.0/(gauss/std_gauss)^2
weights_cohe = 1.0/(coherent/std_coherent)^2

curve_w = CURVEFIT(wav_k[8:21], coherent[8:21], weights_cohe[8:21], A, sigma, CHISQ=chisq, fita=[1,1,1], FUNCTION_NAME='power_law',itmax=1000)

print, A

END