PRO fit_serpens

wav_k=[0.0038961, 0.00517729, 0.00687979, 0.00914213, 0.01214843, 0.0161433, 0.02145185, 0.02850606, 0.03787997, 0.05033638, 0.06688895, 0.08888465, 0.1181134, 0.15695371, 0.20856622, 0.27715095, 0.36828902, 0.48939685, 0.65032968, 0.8641835, 1.14836082, 1.52598676, 2.02779087, 2.6946078]

spec=[7.63446649e+04, 8.49785507e+03, 4.59582978e+04, 6.19902400e+04, 2.28519921e+04, 2.34685446e+04, 1.36144536e+04, 9.70332898e+03, 7.48504187e+03, 3.88534580e+03, 2.44002839e+03, 1.46769089e+03, 8.42434013e+02, 4.40254599e+02, 2.28233581e+02, 1.28646100e+02, 6.84267547e+01, 3.71521160e+01, 1.90868816e+01, 1.00457461e+01, 6.00863478e+00, 4.98306825e+00, 7.97730859e+00, 4.13445583e+00]

gauss=[7.63446614e+04,  8.49785159e+03,  4.59582943e+04,  6.19902365e+04, 2.28519887e+04,  2.32614863e+04,  1.17112461e+04,  4.29661859e+03, 2.33455506e+03,  7.06250816e+02,  2.25788291e+02,  5.79313086e+01, 2.02263256e+01,  9.56953302e+00,  3.68753966e+00,  1.59970982e+00, 6.61002003e-01,  3.19234449e-01,  1.63221346e-01,  9.43311890e-02, 5.04915450e-02, -3.93204327e-01, -7.89902257e+00, -5.32690498e+01]


coherent=[-3.48462666e-03, -3.48462666e-03, -3.48462666e-03, -3.48462666e-03, -3.48462666e-03,  2.07051250e+02,  1.90320053e+03,  5.40670352e+03, 5.15047985e+03,  3.17908793e+03,  2.21423288e+03,  1.40975210e+03, 8.22199788e+02,  4.30676543e+02,  2.24536578e+02,  1.27035372e+02, 6.77520088e+01,  3.68139249e+01,  1.88927639e+01,  9.88730498e+00, 5.74661802e+00,  3.69666569e+00, -4.26563750e+00, -5.16434565e+01]

A=[9.0346, -2.0671, 0.1]

std_gauss= 20718.9
std_coherent=1563.9
std_spec=20446.3

weights_spec = 1.0/(spec/std_spec)^2
weights_gauss = 1.0/(gauss/std_gauss)^2
weights_cohe = 1.0/(coherent/std_coherent)^2

curve_w = CURVEFIT(wav_k[10:21], coherent[10:21], weights_cohe[10:21], A, sigma, CHISQ=chisq, fita=[1,1,1], FUNCTION_NAME='power_law',itmax=1000)
print, A


END