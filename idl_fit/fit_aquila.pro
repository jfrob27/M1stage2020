PRO fit_aquila

wav_k=[0.00535714, 0.00711878, 0.00945971, 0.01257043, 0.01670409, 0.02219704, 0.0294963 , 0.03919583, 0.05208495, 0.06921252, 0.09197231, 0.1222164 , 0.16240593, 0.21581135, 0.28677856, 0.38108256, 0.50639741, 0.67292067, 0.8942033 , 1.18825231, 1.57899613, 2.0982318 , 2.78821245]

spec=[2.10319043e+06, 9.22035290e+05, 4.94514960e+05, 4.10999108e+05, 1.42811046e+05, 8.97939608e+04, 3.71839278e+04, 1.60386678e+04, 8.94933442e+03, 7.31087420e+03, 5.06092936e+03, 3.13015713e+03, 1.76986049e+03, 9.67836209e+02, 5.24342534e+02, 2.82143644e+02, 1.65553334e+02, 9.30307089e+01, 5.08829246e+01, 2.94482814e+01, 2.30591373e+01, 3.09838822e+01, 1.41801811e+01]

gauss=[2.10319042e+06,  9.22035277e+05,  4.94514947e+05,  4.10999095e+05, 1.10097521e+05,  4.65705312e+04,  1.00212858e+04,  2.73862981e+03,  1.08779406e+03,  4.05559193e+02,  2.14889756e+02,  6.83772438e+01, 2.37566540e+01,  1.04852484e+01,  3.91512845e+00,  1.77053780e+00, 9.04479738e-01,  4.70677036e-01,  2.22284664e-01, -7.29080824e-02, -3.22518488e+00, -4.36326630e+01, -2.72663544e+02]

coherent=[-1.28518448e-02, -1.28518448e-02, -1.28518448e-02, -1.28518448e-02, 3.27134994e+04,  4.32234031e+04,  2.71626153e+04,  1.33000110e+04, 7.86151302e+03,  6.90528701e+03,  4.84601051e+03,  3.06174909e+03, 1.74607051e+03,  9.57313800e+02,  5.20383824e+02,  2.80318210e+02, 1.64571903e+02,  9.24314786e+01,  5.03835657e+01,  2.85261676e+01, 1.74075072e+01, -2.14933547e+01, -2.62780748e+02]

A=[49.602, -1.8761, 0.1]

std_gauss= 464849.6
std_coherent=11638.0
std_spec=463156.8

weights_spec = 1.0/(spec/std_spec)^2
weights_gauss = 1.0/(gauss/std_gauss)^2
weights_cohe = 1.0/(coherent/std_coherent)^2

curve_w = CURVEFIT(wav_k[6:18], gauss[6:18], weights_gauss[6:18], A, sigma, CHISQ=chisq, fita=[1,1,1], FUNCTION_NAME='power_law',itmax=1000)

print, A

END