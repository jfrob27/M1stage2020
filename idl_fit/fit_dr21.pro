PRO fit_dr21

wav_k=[0.00571428, 0.00759336, 0.01009036, 0.01340846, 0.01781769, 0.02367684, 0.03146272, 0.04180889, 0.05555728, 0.07382669, 0.0981038 , 0.13036416, 0.17323299, 0.23019877, 0.30589713, 0.40648807, 0.54015723, 0.71778205, 0.95381686, 1.26746913, 1.68426254, 2.23811392, 2.97409328]

gauss=[3.00202787e+05,  2.79519099e+05,  1.07459572e+05,  7.77121046e+04, 3.48355311e+04,  2.60135467e+04,  1.09632764e+04,  4.47516838e+03, 1.73834206e+03,  8.44880805e+02,  3.73740630e+02,  1.65466187e+02, 7.87055663e+01,  3.56788335e+01,  1.60533326e+01,  7.07115243e+00, 3.18580884e+00,  1.40988876e+00,  3.16327532e-01, -1.83883170e+00, -2.59141568e+01, -2.24128935e+02, -1.60547582e+03]

coherent=[-4.24074714e-02, -4.24074714e-02, -4.24074714e-02,  4.31138843e+02, 3.00106162e+03,  1.29105378e+04,  2.73662986e+04,  1.69471983e+04, 2.04747592e+04,  1.41873746e+04,  8.93051087e+03,  6.04955046e+03, 4.07922404e+03,  2.77957857e+03,  2.05269440e+03,  1.40967559e+03, 8.49904647e+02,  5.20305444e+02,  3.23553936e+02,  2.28394186e+02, 1.88116957e+02, -6.26653865e+01, -1.53287883e+03]

A=[335.670, -1.43023, 6.33016]

std_gauss= 82622.4
std_coherent=7647.0

weights_gauss = 1.0/(gauss/std_gauss)^2
weights_cohe = 1.0/(coherent/std_coherent)^2

curve_w = CURVEFIT(wav_k[8:20], coherent[8:20], weights_cohe[8:20], A, sigma, CHISQ=chisq, fita=[1,1,1], FUNCTION_NAME='power_law',itmax=1000)

print, A

END