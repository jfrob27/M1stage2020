PRO fit_velac

wav_k=[0.00504202, 0.00670003, 0.00890326, 0.011831  , 0.01572149, 0.02089133, 0.02776122, 0.0368902 , 0.04902113, 0.0651412 , 0.08656217, 0.1150272 , 0.15285264, 0.20311656, 0.26990923, 0.35866594, 0.47660932, 0.63333711, 0.84160311, 1.11835512, 1.48611401, 1.9748064 , 2.62419995]

gauss=[2.56976065e+05,  1.06480482e+05,  7.70161927e+05,  2.13982772e+05, 3.33802465e+05,  1.82929914e+05,  8.23599553e+04,  2.29665696e+04, 5.40093300e+03,  1.35254588e+03,  4.45684348e+02,  1.12443076e+02, 3.35363003e+01,  1.12054413e+01,  3.76967978e+00,  1.42381747e+00, 5.47063933e-01,  1.98324931e-01, -3.42699537e-02, -4.70725423e-01, -4.04542798e+00, -5.25033845e+01, -2.84982323e+02]

coherent=[-2.35888626e-02, -2.35888626e-02, -2.35888626e-02, -2.35888626e-02, 4.21513093e+03,  8.57369732e+03,  5.66984445e+03,  2.14821142e+04, 1.39992036e+04,  1.04107928e+04,  7.69936160e+03,  4.39516265e+03, 2.50144198e+03,  1.35434112e+03,  7.94713907e+02,  4.30129402e+02, 2.39044582e+02,  1.33597123e+02,  7.77137234e+01,  4.52370984e+01, 2.87282959e+01, -8.34163693e+00, -2.59719062e+02]

A=[49.6860, -2.07343, 7.73540]

std_gauss= 174288.7
std_coherent=5461.8

weights_gauss = 1.0/(gauss/std_gauss)^2
weights_cohe = 1.0/(coherent/std_coherent)^2

curve_w = CURVEFIT(wav_k[10:20], coherent[10:20], weights_cohe[10:20], A, sigma, CHISQ=chisq, fita=[1,1,1], FUNCTION_NAME='power_law',itmax=1000)

print, A

END