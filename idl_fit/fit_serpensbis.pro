PRO fit_serpensbis

wav_k=[0.00612245, 0.00813575, 0.0108111, 0.01436621, 0.01909038, 0.02536805, 0.03371005, 0.04479524, 0.05952566, 0.07910003, 0.10511121, 0.13967588, 0.18560678, 0.24664154, 0.32774692, 0.43552293, 0.57873989, 0.7690522, 1.02194663, 1.35800264, 1.80456701, 2.3979792, 3.18652852]

spec=[1.36855553e+05, 9.73551582e+04, 5.03079919e+04, 4.78840653e+04, 3.95268240e+04, 2.66310623e+04, 1.71640277e+04, 1.07583708e+04, 7.24775125e+03, 4.98363355e+03, 2.89220976e+03, 1.49983624e+03, 8.91068241e+02, 5.58412179e+02, 2.91572074e+02, 1.28879959e+02, 6.26948794e+01, 4.69426589e+01, 3.73160418e+01, 3.11809176e+01, 3.00515398e+01, 2.29399892e+01, 8.44252181e+00]

gauss=[1.36855541e+05,  9.73551462e+04,  5.03079799e+04,  4.77993998e+04, 3.95268119e+04,  1.93068279e+04,  4.13427937e+03,  1.21585897e+03, 3.29150265e+02,  8.18163571e+01,  3.23212494e+01,  7.51430822e+00, 3.07398969e+00,  1.52680278e+00,  6.24098713e-01,  2.87572172e-01, 1.33628459e-01,  4.27610715e-02, -6.96583632e-02, -8.17041540e-01, -1.23348767e+01, -8.63318637e+01, -8.79521573e+02]

coherent=[-1.20031416e-02, -1.20031416e-02, -1.20031416e-02,  8.46414640e+01, -1.20031416e-02,  7.32421041e+03,  1.30297244e+04,  9.54248762e+03, 6.91857636e+03,  4.90179182e+03,  2.85986193e+03,  1.49229353e+03, 8.87963124e+02,  5.56849939e+02,  2.90905096e+02,  1.28535997e+02, 6.24761751e+01,  4.67418908e+01,  3.69745165e+01,  2.98070709e+01, 1.46305722e+01, -6.74142555e+01, -8.72594583e+02]

A=[25.7024, -2.06607, 0.1]

std_gauss= 34990.9
std_coherent=3621.2
std_spec=34379.1

weights_spec = 1.0/(spec/std_spec)^2
weights_gauss = 1.0/(gauss/std_gauss)^2
weights_cohe = 1.0/(coherent/std_coherent)^2

curve_w = CURVEFIT(wav_k[5:17], gauss[5:17], weights_gauss[5:17], A, sigma, CHISQ=chisq, fita=[1,1,1], FUNCTION_NAME='power_law',itmax=1000)
print, A


END